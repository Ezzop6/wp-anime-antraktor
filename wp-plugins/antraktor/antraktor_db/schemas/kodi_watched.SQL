CREATE TABLE |DB_PREFIX|kodi_watched (
    record_key VARCHAR(255) UNIQUE PRIMARY KEY NOT NULL,
    record_hash VARCHAR(255) NOT NULL,
    record_length INT NOT NULL,
    record_data TEXT NOT NULL,
    tmdb_data TEXT DEFAULT NULL,
    name VARCHAR(255) NOT NULL,
    number_of_episodes INT NULL,
    number_of_seasons INT NULL,
    tvdb_show_id VARCHAR(50) NULL,
    id_imdb VARCHAR(50) NULL,
    id_tvdb VARCHAR(50) NULL,
    id_tmdb VARCHAR(50) NULL,
    watch_status VARCHAR(50) NOT NULL DEFAULT 'not_started',
    watch_progress TINYINT(2) NOT NULL DEFAULT 0,
    watch_count INT NOT NULL DEFAULT 0,
    watch_first_time DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL,
    watch_last_time DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL,
    show_type VARCHAR(50) NOT NULL,
    data_completed BOOLEAN NOT NULL DEFAULT FALSE,
    data_conected BOOLEAN NOT NULL DEFAULT FALSE,
    movie_id INT NULL,
    tmdb_series_id VARCHAR(20) NULL,
    tmdb_season_id INT NULL,
    tmdb_episode_id INT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL,
    INDEX (movie_id),
    INDEX (tmdb_series_id),
    INDEX (tmdb_season_id),
    INDEX (tmdb_episode_id),
    FOREIGN KEY (movie_id) REFERENCES |DB_PREFIX|movies(id),
    FOREIGN KEY (tmdb_series_id) REFERENCES |DB_PREFIX|series(tmdb_series_id),
    FOREIGN KEY (tmdb_season_id) REFERENCES |DB_PREFIX|seasons(id),
    FOREIGN KEY (tmdb_episode_id) REFERENCES |DB_PREFIX|episodes(tmdb_episode_id)
)   |DB_COLLATE|;
